(function(a){self.KCate=a;if(typeof module!=="undefined"&&typeof exports==="object"){module.exports=a}else{if(typeof define=="function"&&define.amd){define("KCate",[],function(){return a})}}})(function(h){var b={el:"",level:{one:"h2",two:"h3",}};function q(w,v){for(var j in v){if(typeof v[j]=="object"){q(w[j],v[j])}else{w[j]=v[j]}}return w}this.opts=q(b,h);var r=document.getElementById(this.opts.el);var e=document.getElementById(this.opts.target);this.treeId=s();this.treeObj=[];var d=this;var u=document.getElementsByTagName(this.opts.level.one);for(var o=0;o<u.length;o++){var k=u[o];var m="k-cate-"+o;k.setAttribute("id",m);var t={ele:k,text:k.innerText,next:[]};t.next=g(k,this.opts.level.one,this.opts.level.two,m);if(this.opts.level.three){for(var n=0;n<t.next.length;n++){t.next[n].next=g(t.next[n].ele,this.opts.level.two,this.opts.level.three,t.next[n].ele.id)}}this.treeObj.push(t)}if(e){e.appendChild(p(this.treeObj,this.opts.linkClass))}else{throw new Error("target options is not set")}window.onscroll=function(){var z=document.documentElement.scrollTop||document.body.scrollTop;var j=r.querySelectorAll(d.opts.level.one+","+d.opts.level.two+","+d.opts.level.three);var y=c(j,z);var A=y.id;var x=e.getElementsByTagName("a");for(var v=0;v<x.length;v++){if(x[v].getAttribute("href")!="#"+A){l(x[v],d.opts.linkActiveClass)}}var w=e.querySelector("a[href='#"+A+"']");f(w,d.opts.linkActiveClass)};function c(j,w){for(var v=j.length-1;v>=0;v--){if(j[v].offsetTop<=w){return j[v]}}}function f(j,i){if(!j.className){j.className=i}else{if(!a(j,i)){j.className=j.className+" "+i}}}function l(j,i){if(a(j,i)){j.className=(j.className.replace(i,"")).trim();if(!j.className){j.removeAttribute("class")}}}function a(j,i){return j.className.indexOf(i)==-1?false:true}function p(y,z){var x=document.createElement("ul");for(var w=0;w<y.length;w++){var j=document.createElement("li");var v=document.createElement("a");if(z){v.className=z}v.href="#"+y[w].ele.id;v.innerText=y[w].text;j.appendChild(v);if(y[w].next&&y[w].next.length>0){j.appendChild(p(y[w].next,z))}x.appendChild(j)}return x}function g(x,w,v,y){var j=[];w=w.toUpperCase();v=v.toUpperCase();var i=0;while(x=x.nextSibling){if(x.tagName===w){break}if(x.nodeType==1){if(x.tagName!==w){if(x.tagName==v){x.id=y+"-"+i;j.push({ele:x,text:x.innerText,next:[]});i++}}else{break}}}return j}function s(){return new Date().getTime()+"_"+"cate"}});